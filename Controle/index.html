<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contr√¥le Documentaire - Cabinet de Gestion de Patrimoine</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Contr√¥le Documentaire</h1>
            <p>Cabinet de Gestion de Patrimoine - Interface de gestion compl√®te</p>
        </div>

        <!-- Debug Panel -->
        <div class="debug-panel" id="debug-panel">
            <div class="debug-title">üîç Informations de d√©bogage</div>
            <div id="debug-content"></div>
        </div>

        <!-- Section 1: File Upload -->
        <div class="content-section active" id="file-upload-section">
            <h2 class="section-title">√âtape 1 : Ouverture du fichier Excel</h2>
            
            <div class="file-upload-area" onclick="document.getElementById('file-input').click()">
                <div class="upload-icon">üìÅ</div>
                <div class="upload-text">Cliquez pour s√©lectionner le fichier Excel</div>
                <div class="upload-subtext">ou glissez-d√©posez le fichier ici<br>Formats accept√©s: .xlsx, .xls, .xlsm</div>
            </div>
            
            <input type="file" id="file-input" class="file-input" accept=".xlsx,.xls,.xlsm">
            
            <div class="file-info" id="file-info">
                <div class="file-name" id="file-name"></div>
                <div class="file-stats">
                    <div class="file-stat">
                        <div class="stat-number" id="total-rows">0</div>
                        <div class="stat-label">Dossiers trouv√©s</div>
                    </div>
                    <div class="file-stat">
                        <div class="stat-number" id="total-columns">0</div>
                        <div class="stat-label">Colonnes</div>
                    </div>
                    <div class="file-stat">
                        <div class="stat-number" id="file-size">0 KB</div>
                        <div class="stat-label">Taille du fichier</div>
                    </div>
                </div>
                
                <div class="btn-group">
                    <button class="btn btn-success" onclick="proceedToSelection()">
                        Continuer vers la s√©lection
                    </button>
                    <button class="btn btn-warning" onclick="showAutomaticControls()">
                        Contr√¥les automatiques
                    </button>
                    <button class="btn btn-secondary" onclick="resetFile()">
                        Changer de fichier
                    </button>
                    <button class="btn btn-debug btn-sm" onclick="toggleDebug()">
                        Afficher/Masquer Debug
                    </button>
                </div>
            </div>
        </div>

        <!-- Section 2: Dossier Selection -->
        <div class="content-section" id="dossier-selection-section">
            <h2 class="section-title">√âtape 2 : S√©lection des dossiers √† contr√¥ler</h2>
            
            <!-- Filters -->
            <div class="filters-section">
                <h3 style="margin-bottom: 15px; color: #1a1a2e;">Filtres</h3>
                <div class="filters-grid">
                    <div class="filter-group">
                        <label class="filter-label">Conseiller</label>
                        <select class="filter-select" id="filter-conseiller">
                            <option value="">Tous les conseillers</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Domaine</label>
                        <select class="filter-select" id="filter-domaine">
                            <option value="">Tous les domaines</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Nouveau Client</label>
                        <select class="filter-select" id="filter-nouveau">
                            <option value="">Tous</option>
                            <option value="Oui">Nouveaux clients uniquement</option>
                            <option value="Non">Clients existants uniquement</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Recherche</label>
                        <input type="text" class="filter-input" id="filter-search" placeholder="Nom, pr√©nom, r√©f√©rence...">
                    </div>
                </div>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="applyFilters()">Appliquer les filtres</button>
                    <button class="btn btn-secondary" onclick="clearFilters()">Effacer</button>
                    <button class="btn btn-warning" onclick="showFileUpload()">Changer de fichier</button>
                    <button class="btn btn-info" onclick="showAutomaticControls()">Contr√¥les automatiques</button>
                </div>
            </div>

            <!-- Selection Summary -->
            <div class="selection-summary" id="selection-summary">
                <div class="selection-count">
                    <span id="selected-count">0</span> dossier(s) s√©lectionn√©(s)
                </div>
                <div class="btn-group">
                    <button class="btn btn-success" onclick="proceedToControl()">
                        D√©marrer le contr√¥le
                    </button>
                    <button class="btn btn-secondary" onclick="clearSelection()">
                        D√©s√©lectionner tout
                    </button>
                </div>
            </div>

            <!-- Table -->
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>
                                <div class="checkbox-container">
                                    <div class="checkbox" id="select-all-checkbox" onclick="toggleSelectAll()"></div>
                                </div>
                            </th>
                            <th>Client</th>
                            <th>Code Dossier</th>
                            <th>Assistant BO</th>
                            <th>Conseiller</th>
                            <th>Domaine</th>
                            <th>Contrat</th>
                            <th>Type Acte</th>
                            <th>Montant</th>
                            <th>√âtat BO</th>
                            <th>Nouveau</th>
                            <th>PPE</th>
                        </tr>
                    </thead>
                    <tbody id="dossiers-table-body">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Section 3: Automatic Controls -->
        <div class="content-section" id="automatic-control-section">
            <h2 class="section-title">√âtape 3 : Contr√¥les automatiques</h2>
            
            <div class="automatic-controls-intro">
                <p>S√©lectionnez le type de contr√¥le √† effectuer. Le syst√®me choisira automatiquement un √©chantillon de dossiers selon les crit√®res d√©finis pour chaque type de contr√¥le.</p>
            </div>

            <div class="control-types-grid">
                <!-- Les cartes de contr√¥le seront g√©n√©r√©es dynamiquement par JavaScript -->
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="showFileUpload()">
                    Changer de fichier
                </button>
                <button class="btn btn-info" onclick="showDossierSelection()">
                    S√©lection manuelle
                </button>
                <button class="btn btn-info" onclick="showHistory()">
                    üìã Voir l'historique
                </button>
            </div>
        </div>

        <!-- Section 3bis: Sample Selection -->
        <div class="content-section" id="sample-selection-section">
            <h2 class="section-title">√âtape 3bis : S√©lection dans l'√©chantillon</h2>
            
            <div class="sample-info">
                <p>Choisissez le dossier √† contr√¥ler dans l'√©chantillon g√©n√©r√© automatiquement :</p>
            </div>

            <div class="sample-table-container">
                <table class="sample-table">
                    <thead>
                        <tr>
                            <th>Client</th>
                            <th>Code Dossier</th>
                            <th>Conseiller</th>
                            <th>Montant</th>
                            <th>Domaine</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="sample-table-body">
                        <!-- Les dossiers de l'√©chantillon seront g√©n√©r√©s dynamiquement -->
                    </tbody>
                </table>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="showAutomaticControls()">
                    Retour aux contr√¥les
                </button>
                <button class="btn btn-info" onclick="showDossierSelection()">
                    S√©lection manuelle
                </button>
            </div>
        </div>

        <!-- Section 3ter: Document Control -->
        <div class="content-section" id="document-control-section">
            <h2 class="section-title">Contr√¥le Documentaire</h2>
            
            <!-- Informations du dossier -->
            <div id="dossier-info">
                <!-- Les informations du dossier seront g√©n√©r√©es dynamiquement -->
            </div>

            <!-- Grille des documents -->
            <div class="documents-section">
                <h3>Documents √† contr√¥ler</h3>
                <div id="documents-grid" class="documents-grid">
                    <!-- Les cartes de documents seront g√©n√©r√©es dynamiquement -->
                </div>
            </div>

            <!-- Boutons de contr√¥le -->
            <div id="control-buttons">
                <!-- Les boutons seront g√©n√©r√©s dynamiquement -->
            </div>
        </div>

        <!-- Section 3quater: Question Interface -->
        <div class="content-section" id="question-interface-section">
            <h2 class="section-title">Questions du document</h2>
            
            <div id="question-container">
                <!-- L'interface de questions sera g√©n√©r√©e dynamiquement -->
            </div>
        </div>

        <!-- Section 4: Control Interface -->
        <div class="content-section" id="control-section">
            <h2 class="section-title">√âtape 4 : Interface de contr√¥le</h2>
            
            <div class="control-content">
                <p>Interface de contr√¥le en cours de d√©veloppement...</p>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="showDossierSelection()">
                    Retour √† la s√©lection
                </button>
                <button class="btn btn-info" onclick="showAutomaticControls()">
                    Contr√¥les automatiques
                </button>
                <button class="btn btn-success" onclick="downloadResults()">
                    T√©l√©charger les r√©sultats
                </button>
            </div>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
